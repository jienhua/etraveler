"use strict";angular.module("sampleApp",["ui.router","appRoutes","MainCtrl","TravelerCtrl","SearchTravelerCtrl","FormGenCtrl.js","TravelerService","FormService"]),angular.module("appRoutes",["ui.router"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,r,t){r.otherwise("/home"),e.state("home",{url:"/home",templateUrl:"views/home.html",controller:"MainController"}).state("traveler",{url:"/traveler?_id&formId",views:{"":{templateUrl:"views/traveler.html",controller:"TravelerController"},"formReview@traveler":{templateUrl:"views/formReview.html",controller:function(e,r,t){e.reviewData=r.getReviewData(),t.get(e.reviewData.formId).success(function(r){console.log(e.reviewData.formId),console.log(r),e.forms=r})}}}}).state("searchTraveler",{url:"/searchTraveler",templateUrl:"views/searchTraveler.html",controller:"SearchTravelerController"}).state("formGenerator",{url:"/formGenerator",templateUrl:"views/formGenerator.html",controller:"FormGeneratorController"}),t.html5Mode(!0)}]),angular.module("FormGenCtrl.js",[]).controller("FormGeneratorController",["$scope","Form",function(e,r){e.submit=function(){var t=prompt("password");"123"===t?r.create(e.template).success(function(e){alert("add")}):alert("go home son")}}]),angular.module("MainCtrl",[]).controller("MainController",["$scope",function(e){e.tagline="to the moon and back!"}]),angular.module("SearchTravelerCtrl",[]).controller("SearchTravelerController",["$scope","Traveler",function(e,r){e.isSearch=!1,e.search=function(){if(e.currentInput=e.searchInput,e.isSearch=!0,e.searchInput){var t=e.searchInput.toString();r.searchLike(t).success(function(r){e.result=r})}},e.editTraveler=function(e,r){window.open("traveler?_id="+e+"&formId="+r,"_blank")},e.removeTraveler=function(t,a){r.removeTraveler(t).success(function(r){e.result.splice(a,1)})}}]),angular.module("TravelerCtrl",[]).controller("TravelerController",["$scope","Traveler","Form","$stateParams",function(e,r,t,a){e.updateForm=function(){e.travelerData={},e.formId&&t.get(e.formId).success(function(r){e.forms=r,e.lastStep=r.steps.length,e.travelerData.formId=r.formId})},e.nextStep=function(){var t=e.forms.steps[e.currentStep-1];t.list.length>=e.currentSubStep+1?e.currentSubStep+=1:(e.currentStep+=1,e.currentSubStep=1,e.currentStep>e.lastStep&&(r.setReviewData(e.travelerData),e.readySubmit=!0))},e.statusPage=function(r){e.currentStep=r,e.currentSubStep=1,e.readySubmit=!1},e.statusSubPage=function(r){e.currentSubStep=r},e.goBack=function(){e.currentStep=1,e.currentSubStep=1,e.readySubmit=!1},e.save=function(){e.travelerData.created?n()&&r.save(e.travelerData).success(function(e){}):e.submit()},e.submit=function(){document.getElementById("username").value?(e.travelerData.created=!0,e.travelerData.createdBy=document.getElementById("username").value,e.travelerData.createAt=new Date,r.create(e.travelerData).success(function(r){console.log(r),e.travelerData=r})):alert("enter you name plz")},e["new"]=function(){l()},e["delete"]=function(){alert("delete click"),e.travelerData._id&&r.removeTraveler(e.travelerData._id).success(function(e){l()})};var n=function(){var r=document.getElementById("username").value;if(""!==r){var t=e.currentStep,a=e.currentSubStep;return e.travelerData.step[t][a].editBy=r,e.travelerData.step[t][a].editTime=new Date,!0}return alert("enter your name"),!1},o=function(){t.getFormList().success(function(r){e.formList=r})},l=function(){e.travelerData={},e.currentStep=1,e.currentSubStep=1,e.readySubmit=!1,e.formId="",e.isNew=!0},u=function(){e.$watch("travelerData.step",function(r,t){e.isNew?(console.log(e.currentStep+";"+e.currentSubStep+"changed"),n()):e.isNew=!0},!0)},c=function(){l(),o(),a.formId&&(e.formId=a.formId,e.updateForm(),e.isNew=!1),a._id&&(e.isNew=!1,r.get(a._id).success(function(r){e.travelerData=r,u()}))};c()}]),angular.module("FormService",[]).factory("Form",["$http",function(e){return{create:function(r){return e.post("/api/forms",r)},getFormList:function(){return e.get("/api/forms/")},get:function(r){return e.get("/api/forms/"+r)}}}]),angular.module("TravelerService",[]).factory("Traveler",["$http",function(e){var r={};return{create:function(r){return e.post("/api/traveler",r)},getReviewData:function(){return r},get:function(r){return e.get("/api/traveler?_id="+r)},save:function(r){return e.put("/api/traveler",r)},setReviewData:function(e){r=e},searchLike:function(r){return e.get("/api/traveler/searchLike/"+r)},removeTraveler:function(r,t){return console.log(r),e["delete"]("/api/traveler/"+r)}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJ1bmRsZS5qcyIsImFwcC5qcyIsImFwcFJvdXRlcy5qcyIsImNvbnRyb2xsZXJzL0Zvcm1HZW5DdHJsLmpzIiwiY29udHJvbGxlcnMvTWFpbkN0cmwuanMiLCJjb250cm9sbGVycy9TZWFyY2hUcmF2ZWxlckN0cmwuanMiLCJjb250cm9sbGVycy9UcmF2ZWxlckN0cmwuanMiLCJzZXJ2aWNlcy9Gb3JtU2VydmljZS5qcyIsInNlcnZpY2VzL1RyYXZlbGVyU2VydmljZS5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsIm90aGVyd2lzZSIsInN0YXRlIiwidXJsIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwidmlld3MiLCIiLCJmb3JtUmV2aWV3QHRyYXZlbGVyIiwiJHNjb3BlIiwiVHJhdmVsZXIiLCJGb3JtIiwicmV2aWV3RGF0YSIsImdldFJldmlld0RhdGEiLCJnZXQiLCJmb3JtSWQiLCJzdWNjZXNzIiwiZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJmb3JtcyIsImh0bWw1TW9kZSIsInN1Ym1pdCIsInBhc3N3b3JkIiwicHJvbXB0IiwiY3JlYXRlIiwidGVtcGxhdGUiLCJhbGVydCIsInRhZ2xpbmUiLCJpc1NlYXJjaCIsInNlYXJjaCIsImN1cnJlbnRJbnB1dCIsInNlYXJjaElucHV0Iiwic24iLCJ0b1N0cmluZyIsInNlYXJjaExpa2UiLCJyZXN1bHQiLCJlZGl0VHJhdmVsZXIiLCJfaWQiLCJ3aW5kb3ciLCJvcGVuIiwicmVtb3ZlVHJhdmVsZXIiLCJpbmRleCIsInNwbGljZSIsIiRzdGF0ZVBhcmFtcyIsInVwZGF0ZUZvcm0iLCJ0cmF2ZWxlckRhdGEiLCJsYXN0U3RlcCIsInN0ZXBzIiwibGVuZ3RoIiwibmV4dFN0ZXAiLCJvYmplY3QiLCJjdXJyZW50U3RlcCIsImxpc3QiLCJjdXJyZW50U3ViU3RlcCIsInNldFJldmlld0RhdGEiLCJyZWFkeVN1Ym1pdCIsInN0YXR1c1BhZ2UiLCJwYWdlIiwic3RhdHVzU3ViUGFnZSIsImdvQmFjayIsInNhdmUiLCJjcmVhdGVkIiwiYXBwZW5kU3ViU3RlcEVkaXRJbmZvIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInZhbHVlIiwiY3JlYXRlZEJ5IiwiY3JlYXRlQXQiLCJEYXRlIiwicmVzZXQiLCJ1c2VybmFtZSIsInN0ZXAiLCJlZGl0QnkiLCJlZGl0VGltZSIsImxvYWRGb3JtTGlzdCIsImdldEZvcm1MaXN0IiwiZm9ybUxpc3QiLCJpc05ldyIsInN0YXJ0V2F0Y2giLCIkd2F0Y2giLCJuZXdWYWx1ZSIsIm9sZFZhbHVlIiwibWFpbiIsImZhY3RvcnkiLCIkaHR0cCIsInBvc3QiLCJmb3JtRGF0YSIsInB1dCIsImlucHV0Il0sIm1hcHBpbmdzIjoiQUFBQSxZQ0FBQSxTQUFRQyxPQUFPLGFBRWIsWUFDQSxZQUVBLFdBQ0EsZUFDQSxxQkFDQSxpQkFFQSxrQkFDQSxnQkNYRkQsUUFBUUMsT0FBTyxhQUFjLGNBQzNCQyxRQUFRLGlCQUFrQixxQkFBc0Isb0JBQ2hELFNBQVNDLEVBQWdCQyxFQUFvQkMsR0FFN0NELEVBQW1CRSxVQUFVLFNBRzdCSCxFQUdFSSxNQUFNLFFBQ05DLElBQUssUUFDTEMsWUFBYSxrQkFDYkMsV0FBWSxtQkFJWkgsTUFBTSxZQUNOQyxJQUFLLHVCQUNMRyxPQUNDQyxJQUNDSCxZQUFhLHNCQUNiQyxXQUFZLHNCQUViRyx1QkFDQ0osWUFBYSx3QkFDYkMsV0FBWSxTQUFTSSxFQUFRQyxFQUFVQyxHQUN0Q0YsRUFBT0csV0FBYUYsRUFBU0csZ0JBSzdCRixFQUFLRyxJQUFJTCxFQUFPRyxXQUFXRyxRQUN6QkMsUUFBUSxTQUFTQyxHQUVqQkMsUUFBUUMsSUFBSVYsRUFBT0csV0FBV0csUUFDOUJHLFFBQVFDLElBQUlGLEdBQ1pSLEVBQU9XLE1BQVFILFNBWXBCZixNQUFNLGtCQUNOQyxJQUFLLGtCQUNMQyxZQUFhLDRCQUNiQyxXQUFZLDZC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RSxFQUFTSSxJQUFJOEIsRUFBYU4sS0FDeEJ0QixRQUFRLFNBQVNDLEdBR2pCUixFQUFPcUMsYUFBZTdCLEVBQ3RCOEQsT0FLSkksUUN0S0Z4RixRQUFRQyxPQUFPLGtCQUVid0YsUUFBUSxRQUFTLFFBQVMsU0FBU0MsR0FFbkMsT0FFQzVELE9BQVEsU0FBU1IsR0FDaEIsTUFBT29FLEdBQU1DLEtBQUssYUFBY3JFLElBR2pDMkQsWUFBYSxXQUNaLE1BQU9TLEdBQU12RSxJQUFJLGdCQUdsQkEsSUFBSyxTQUFTQyxHQUNiLE1BQU9zRSxHQUFNdkUsSUFBSSxjQUFjQyxRQ2ZuQ3BCLFFBQVFDLE9BQU8sc0JBRVZ3RixRQUFRLFlBQWEsUUFBUyxTQUFTQyxHQUVwQyxHQUFJekUsS0FFSixRQUlJYSxPQUFRLFNBQVM4RCxHQUNoQixNQUFPRixHQUFNQyxLQUFLLGdCQUFpQkMsSUFHcEMxRSxjQUFlLFdBQ1gsTUFBT0QsSUFHWEUsSUFBSyxTQUFTd0IsR0FDVixNQUFPK0MsR0FBTXZFLElBQUkscUJBQXNCd0IsSUFHM0N1QixLQUFNLFNBQVM1QyxHQUNYLE1BQU9vRSxHQUFNRyxJQUFJLGdCQUFpQnZFLElBR3RDc0MsY0FBZSxTQUFTdEMsR0FDcEJMLEVBQWFLLEdBR2pCa0IsV0FBWSxTQUFTRixHQUNwQixNQUFPb0QsR0FBTXZFLElBQUksNEJBQTZCbUIsSUFHL0NRLGVBQWdCLFNBQVNILEVBQUttRCxHQUU3QixNQURHdkUsU0FBUUMsSUFBSW1CLEdBQ1IrQyxFQUFBQSxVQUFhLGlCQUFrQi9DIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuYW5ndWxhci5tb2R1bGUoJ3NhbXBsZUFwcCcsIFsndWkucm91dGVyJywgJ2FwcFJvdXRlcycsICdNYWluQ3RybCcsICdUcmF2ZWxlckN0cmwnLCAnU2VhcmNoVHJhdmVsZXJDdHJsJywgJ0Zvcm1HZW5DdHJsLmpzJywgJ1RyYXZlbGVyU2VydmljZScsICdGb3JtU2VydmljZSddKTtcbid1c2Ugc3RyaWN0JztcblxuYW5ndWxhci5tb2R1bGUoJ2FwcFJvdXRlcycsIFsndWkucm91dGVyJ10pLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsIGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuXG5cdCR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy9ob21lJyk7XG5cblx0Ly8gJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuXHQkc3RhdGVQcm92aWRlclxuXG5cdC8vIGhvbWUgcGFnZVxuXHQuc3RhdGUoJ2hvbWUnLCB7XG5cdFx0dXJsOiAnL2hvbWUnLFxuXHRcdHRlbXBsYXRlVXJsOiAndmlld3MvaG9tZS5odG1sJyxcblx0XHRjb250cm9sbGVyOiAnTWFpbkNvbnRyb2xsZXInXG5cdH0pLnN0YXRlKCd0cmF2ZWxlcicsIHtcblx0XHR1cmw6ICcvdHJhdmVsZXI/X2lkJmZvcm1JZCcsXG5cdFx0dmlld3M6IHtcblx0XHRcdCcnOiB7XG5cdFx0XHRcdHRlbXBsYXRlVXJsOiAndmlld3MvdHJhdmVsZXIuaHRtbCcsXG5cdFx0XHRcdGNvbnRyb2xsZXI6ICdUcmF2ZWxlckNvbnRyb2xsZXInXG5cdFx0XHR9LFxuXHRcdFx0J2Zvcm1SZXZpZXdAdHJhdmVsZXInOiB7XG5cdFx0XHRcdHRlbXBsYXRlVXJsOiAndmlld3MvZm9ybVJldmlldy5odG1sJyxcblx0XHRcdFx0Y29udHJvbGxlcjogZnVuY3Rpb24gY29udHJvbGxlcigkc2NvcGUsIFRyYXZlbGVyLCBGb3JtKSB7XG5cdFx0XHRcdFx0JHNjb3BlLnJldmlld0RhdGEgPSBUcmF2ZWxlci5nZXRSZXZpZXdEYXRhKCk7XG5cdFx0XHRcdFx0Ly8gYWxlcnQoMTIzKTtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZygkc2NvcGUucmV2aWV3RGF0YSk7XG5cdFx0XHRcdFx0Ly8gYWxlcnQoJHNjb3BlLnJldmlld0RhdGEpO1xuXHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKDEyMyk7XG5cdFx0XHRcdFx0Rm9ybS5nZXQoJHNjb3BlLnJldmlld0RhdGEuZm9ybUlkKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZygncmV2aWV3IGhlcmU/Jyk7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygkc2NvcGUucmV2aWV3RGF0YS5mb3JtSWQpO1xuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coZGF0YSk7XG5cdFx0XHRcdFx0XHQkc2NvcGUuZm9ybXMgPSBkYXRhO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9KVxuXG5cdC8vIC5zdGF0ZSgnbmV3VHJhdmVsZXInLHtcblx0Ly8gXHR1cmw6ICcvbmV3VHJhdmVsZXInLFxuXHQvLyBcdHRlbXBsYXRlVXJsOiAndmlld3MvbmV3VHJhdmVsZXIuaHRtbCdcblx0Ly8gfSlcblxuXHQuc3RhdGUoJ3NlYXJjaFRyYXZlbGVyJywge1xuXHRcdHVybDogJy9zZWFyY2hUcmF2ZWxlcicsXG5cdFx0dGVtcGxhdGVVcmw6ICd2aWV3cy9zZWFyY2hUcmF2ZWxlci5odG1sJyxcblx0XHRjb250cm9sbGVyOiAnU2VhcmNoVHJhdmVsZXJDb250cm9sbGVyJ1xuXHR9KS5zdGF0ZSgnZm9ybUdlbmVyYXRvcicsIHtcblx0XHR1cmw6ICcvZm9ybUdlbmVyYXRvcicsXG5cdFx0dGVtcGxhdGVVcmw6ICd2aWV3cy9mb3JtR2VuZXJhdG9yLmh0bWwnLFxuXHRcdGNvbnRyb2xsZXI6ICdGb3JtR2VuZXJhdG9yQ29udHJvbGxlcidcblx0fSk7XG5cblx0JGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xufV0pO1xuJ3VzZSBzdHJpY3QnO1xuXG5hbmd1bGFyLm1vZHVsZSgnRm9ybUdlbkN0cmwuanMnLCBbXSkuY29udHJvbGxlcignRm9ybUdlbmVyYXRvckNvbnRyb2xsZXInLCBbJyRzY29wZScsICdGb3JtJywgZnVuY3Rpb24gKCRzY29wZSwgRm9ybSkge1xuXG5cdCRzY29wZS5zdWJtaXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIHBhc3N3b3JkID0gcHJvbXB0KCdwYXNzd29yZCcpO1xuXHRcdGlmIChwYXNzd29yZCA9PT0gJzEyMycpIHtcblx0XHRcdEZvcm0uY3JlYXRlKCRzY29wZS50ZW1wbGF0ZSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHQvLyBkbyBzb21ldGhpbmdcblx0XHRcdFx0YWxlcnQoJ2FkZCcpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGFsZXJ0KCdnbyBob21lIHNvbicpO1xuXHRcdH1cblx0fTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxuYW5ndWxhci5tb2R1bGUoJ01haW5DdHJsJywgW10pLmNvbnRyb2xsZXIoJ01haW5Db250cm9sbGVyJywgWyckc2NvcGUnLCBmdW5jdGlvbiAoJHNjb3BlKSB7XG5cblx0JHNjb3BlLnRhZ2xpbmUgPSAndG8gdGhlIG1vb24gYW5kIGJhY2shJztcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxuYW5ndWxhci5tb2R1bGUoJ1NlYXJjaFRyYXZlbGVyQ3RybCcsIFtdKS5jb250cm9sbGVyKCdTZWFyY2hUcmF2ZWxlckNvbnRyb2xsZXInLCBbJyRzY29wZScsICdUcmF2ZWxlcicsIGZ1bmN0aW9uICgkc2NvcGUsIFRyYXZlbGVyKSB7XG5cblx0JHNjb3BlLmlzU2VhcmNoID0gZmFsc2U7XG5cblx0JHNjb3BlLnNlYXJjaCA9IGZ1bmN0aW9uICgpIHtcblx0XHQkc2NvcGUuY3VycmVudElucHV0ID0gJHNjb3BlLnNlYXJjaElucHV0O1xuXHRcdCRzY29wZS5pc1NlYXJjaCA9IHRydWU7XG5cdFx0aWYgKCRzY29wZS5zZWFyY2hJbnB1dCkge1xuXHRcdFx0dmFyIHNuID0gJHNjb3BlLnNlYXJjaElucHV0LnRvU3RyaW5nKCk7XG5cdFx0XHRUcmF2ZWxlci5zZWFyY2hMaWtlKHNuKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdCRzY29wZS5yZXN1bHQgPSBkYXRhO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9O1xuXG5cdCRzY29wZS5lZGl0VHJhdmVsZXIgPSBmdW5jdGlvbiAoX2lkLCBmb3JtSWQpIHtcblx0XHR3aW5kb3cub3BlbigndHJhdmVsZXI/X2lkPScgKyBfaWQgKyAnJmZvcm1JZD0nICsgZm9ybUlkLCAnX2JsYW5rJyk7XG5cdH07XG5cblx0JHNjb3BlLnJlbW92ZVRyYXZlbGVyID0gZnVuY3Rpb24gKF9pZCwgaW5kZXgpIHtcblx0XHRUcmF2ZWxlci5yZW1vdmVUcmF2ZWxlcihfaWQpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdC8vICRzY29wZS5yZXN1bHQ9ZGF0YTtcblx0XHRcdCRzY29wZS5yZXN1bHQuc3BsaWNlKGluZGV4LCAxKTtcblx0XHR9KTtcblx0fTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxuYW5ndWxhci5tb2R1bGUoJ1RyYXZlbGVyQ3RybCcsIFtdKS5jb250cm9sbGVyKCdUcmF2ZWxlckNvbnRyb2xsZXInLCBbJyRzY29wZScsICdUcmF2ZWxlcicsICdGb3JtJywgJyRzdGF0ZVBhcmFtcycsIGZ1bmN0aW9uICgkc2NvcGUsIFRyYXZlbGVyLCBGb3JtLCAkc3RhdGVQYXJhbXMpIHtcblxuXHQkc2NvcGUudXBkYXRlRm9ybSA9IGZ1bmN0aW9uICgpIHtcblx0XHQkc2NvcGUudHJhdmVsZXJEYXRhID0ge307XG5cdFx0aWYgKCRzY29wZS5mb3JtSWQpIHtcblx0XHRcdEZvcm0uZ2V0KCRzY29wZS5mb3JtSWQpLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcblx0XHRcdFx0JHNjb3BlLmZvcm1zID0gZGF0YTtcblx0XHRcdFx0Ly8gZmluZCB0aGUgbGFzdCBzdWJTdGVwXG5cdFx0XHRcdCRzY29wZS5sYXN0U3RlcCA9IGRhdGEuc3RlcHMubGVuZ3RoO1xuXHRcdFx0XHQkc2NvcGUudHJhdmVsZXJEYXRhLmZvcm1JZCA9IGRhdGEuZm9ybUlkO1xuXHRcdFx0XHQvLyAkc2NvcGUubGFzdFN1YlN0ZXAgPSBkYXRhLmZvcm1zLnN0ZXBzW2RhdGEuZm9ybXMuc3RlcHMubGVuZ3RoLTFdLmxpc3QubGVuZ3RoO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9O1xuXG5cdCRzY29wZS5uZXh0U3RlcCA9IGZ1bmN0aW9uICgpIHtcblx0XHQvLyBhcHBlbmRTdWJTdGVwRWRpdEluZm8oKTtcblx0XHR2YXIgb2JqZWN0ID0gJHNjb3BlLmZvcm1zLnN0ZXBzWyRzY29wZS5jdXJyZW50U3RlcCAtIDFdO1xuXHRcdGlmIChvYmplY3QubGlzdC5sZW5ndGggPj0gJHNjb3BlLmN1cnJlbnRTdWJTdGVwICsgMSkge1xuXHRcdFx0JHNjb3BlLmN1cnJlbnRTdWJTdGVwICs9IDE7XG5cdFx0fSBlbHNlIHtcblx0XHRcdCRzY29wZS5jdXJyZW50U3RlcCArPSAxO1xuXHRcdFx0JHNjb3BlLmN1cnJlbnRTdWJTdGVwID0gMTtcblx0XHRcdGlmICgkc2NvcGUuY3VycmVudFN0ZXAgPiAkc2NvcGUubGFzdFN0ZXApIHtcblx0XHRcdFx0VHJhdmVsZXIuc2V0UmV2aWV3RGF0YSgkc2NvcGUudHJhdmVsZXJEYXRhKTtcblx0XHRcdFx0JHNjb3BlLnJlYWR5U3VibWl0ID0gdHJ1ZTtcblx0XHRcdH1cblx0XHR9XG5cdH07XG5cblx0JHNjb3BlLnN0YXR1c1BhZ2UgPSBmdW5jdGlvbiAocGFnZSkge1xuXHRcdC8vIGFwcGVuZFN1YlN0ZXBFZGl0SW5mbygpO1xuXHRcdCRzY29wZS5jdXJyZW50U3RlcCA9IHBhZ2U7XG5cdFx0JHNjb3BlLmN1cnJlbnRTdWJTdGVwID0gMTtcblx0XHQkc2NvcGUucmVhZHlTdWJtaXQgPSBmYWxzZTtcblx0fTtcblxuXHQkc2NvcGUuc3RhdHVzU3ViUGFnZSA9IGZ1bmN0aW9uIChwYWdlKSB7XG5cdFx0Ly8gYXBwZW5kU3ViU3RlcEVkaXRJbmZvKCk7XG5cdFx0JHNjb3BlLmN1cnJlbnRTdWJTdGVwID0gcGFnZTtcblx0fTtcblxuXHQkc2NvcGUuZ29CYWNrID0gZnVuY3Rpb24gKCkge1xuXHRcdCRzY29wZS5jdXJyZW50U3RlcCA9IDE7XG5cdFx0JHNjb3BlLmN1cnJlbnRTdWJTdGVwID0gMTtcblx0XHQkc2NvcGUucmVhZHlTdWJtaXQgPSBmYWxzZTtcblx0fTtcblxuXHQkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdGlmICgkc2NvcGUudHJhdmVsZXJEYXRhLmNyZWF0ZWQpIHtcblx0XHRcdGlmIChhcHBlbmRTdWJTdGVwRWRpdEluZm8oKSkge1xuXG5cdFx0XHRcdFRyYXZlbGVyLnNhdmUoJHNjb3BlLnRyYXZlbGVyRGF0YSkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRcdC8vIGRvIHNvbWV0aGluZ1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0XHQkc2NvcGUuc3VibWl0KCk7XG5cdFx0XHR9XG5cdH07XG5cblx0JHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uICgpIHtcblx0XHRpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJuYW1lJykudmFsdWUpIHtcblx0XHRcdC8vICRzY29wZS50cmF2ZWxlckRhdGEuY29tcGxldGVkID0gZmFsc2U7XG5cdFx0XHQkc2NvcGUudHJhdmVsZXJEYXRhLmNyZWF0ZWQgPSB0cnVlO1xuXHRcdFx0JHNjb3BlLnRyYXZlbGVyRGF0YS5jcmVhdGVkQnkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWUnKS52YWx1ZTtcblx0XHRcdCRzY29wZS50cmF2ZWxlckRhdGEuY3JlYXRlQXQgPSBuZXcgRGF0ZSgpO1xuXHRcdFx0VHJhdmVsZXIuY3JlYXRlKCRzY29wZS50cmF2ZWxlckRhdGEpXG5cblx0XHRcdC8vIGlmIHN1Y2Nlc3NmdWwgY3JlYXRlXG5cdFx0XHQuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhkYXRhKTtcblx0XHRcdFx0JHNjb3BlLnRyYXZlbGVyRGF0YSA9IGRhdGE7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0YWxlcnQoJ2VudGVyIHlvdSBuYW1lIHBseicpO1xuXHRcdH1cblx0fTtcblxuXHQkc2NvcGUubmV3ID0gZnVuY3Rpb24gKCkge1xuXHRcdHJlc2V0KCk7XG5cdH07XG5cblx0JHNjb3BlLmRlbGV0ZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRhbGVydCgnZGVsZXRlIGNsaWNrJyk7XG5cdFx0aWYgKCRzY29wZS50cmF2ZWxlckRhdGEuX2lkKSB7XG5cdFx0XHRUcmF2ZWxlci5yZW1vdmVUcmF2ZWxlcigkc2NvcGUudHJhdmVsZXJEYXRhLl9pZCkuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuXHRcdFx0XHRyZXNldCgpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9O1xuXG5cdHZhciBhcHBlbmRTdWJTdGVwRWRpdEluZm8gPSBmdW5jdGlvbiBhcHBlbmRTdWJTdGVwRWRpdEluZm8oKSB7XG5cdFx0dmFyIHVzZXJuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJuYW1lJykudmFsdWU7XG5cdFx0aWYgKHVzZXJuYW1lICE9PSAnJykge1xuXHRcdFx0dmFyIGN1cnJlbnRTdGVwID0gJHNjb3BlLmN1cnJlbnRTdGVwO1xuXHRcdFx0dmFyIGN1cnJlbnRTdWJTdGVwID0gJHNjb3BlLmN1cnJlbnRTdWJTdGVwO1xuXHRcdFx0JHNjb3BlLnRyYXZlbGVyRGF0YS5zdGVwW2N1cnJlbnRTdGVwXVtjdXJyZW50U3ViU3RlcF0uZWRpdEJ5ID0gdXNlcm5hbWU7XG5cdFx0XHQkc2NvcGUudHJhdmVsZXJEYXRhLnN0ZXBbY3VycmVudFN0ZXBdW2N1cnJlbnRTdWJTdGVwXS5lZGl0VGltZSA9IG5ldyBEYXRlKCk7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdFx0YWxlcnQoJ2VudGVyIHlvdXIgbmFtZScpO1xuXHRcdHJldHVybiBmYWxzZTtcblx0fTtcblxuXHR2YXIgbG9hZEZvcm1MaXN0ID0gZnVuY3Rpb24gbG9hZEZvcm1MaXN0KCkge1xuXHRcdEZvcm0uZ2V0Rm9ybUxpc3QoKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHQkc2NvcGUuZm9ybUxpc3QgPSBkYXRhO1xuXHRcdH0pO1xuXHR9O1xuXG5cdHZhciByZXNldCA9IGZ1bmN0aW9uIHJlc2V0KCkge1xuXHRcdCRzY29wZS50cmF2ZWxlckRhdGEgPSB7fTtcblx0XHQkc2NvcGUuY3VycmVudFN0ZXAgPSAxO1xuXHRcdCRzY29wZS5jdXJyZW50U3ViU3RlcCA9IDE7XG5cdFx0JHNjb3BlLnJlYWR5U3VibWl0ID0gZmFsc2U7XG5cdFx0JHNjb3BlLmZvcm1JZCA9ICcnO1xuXHRcdCRzY29wZS5pc05ldyA9IHRydWU7XG5cdH07XG5cblx0dmFyIHN0YXJ0V2F0Y2ggPSBmdW5jdGlvbiBzdGFydFdhdGNoKCkge1xuXHRcdCRzY29wZS4kd2F0Y2goJ3RyYXZlbGVyRGF0YS5zdGVwJywgZnVuY3Rpb24gKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuXHRcdFx0aWYgKCEkc2NvcGUuaXNOZXcpIHtcblx0XHRcdFx0JHNjb3BlLmlzTmV3ID0gdHJ1ZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKCRzY29wZS5jdXJyZW50U3RlcCArICc7JyArICRzY29wZS5jdXJyZW50U3ViU3RlcCArICdjaGFuZ2VkJyk7XG5cdFx0XHRcdGFwcGVuZFN1YlN0ZXBFZGl0SW5mbygpO1xuXHRcdFx0fVxuXHRcdH0sIHRydWUpO1xuXHR9O1xuXG5cdHZhciBtYWluID0gZnVuY3Rpb24gbWFpbigpIHtcblx0XHRyZXNldCgpO1xuXHRcdGxvYWRGb3JtTGlzdCgpO1xuXG5cdFx0aWYgKCRzdGF0ZVBhcmFtcy5mb3JtSWQpIHtcblx0XHRcdCRzY29wZS5mb3JtSWQgPSAkc3RhdGVQYXJhbXMuZm9ybUlkO1xuXHRcdFx0JHNjb3BlLnVwZGF0ZUZvcm0oKTtcblx0XHRcdCRzY29wZS5pc05ldyA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdGlmICgkc3RhdGVQYXJhbXMuX2lkKSB7XG5cdFx0XHQkc2NvcGUuaXNOZXcgPSBmYWxzZTtcblx0XHRcdFRyYXZlbGVyLmdldCgkc3RhdGVQYXJhbXMuX2lkKS5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XG5cdFx0XHRcdC8vIGRhdGEgaXMgYSBhcnJheS4gcmVzdWx0IGNvdWxkIGJlIG1vcmUgdGhhbiBvbmVcblx0XHRcdFx0Ly8gbmVlZCB0byBkZWFsIHdpdCB0aGlzLlxuXHRcdFx0XHQkc2NvcGUudHJhdmVsZXJEYXRhID0gZGF0YTtcblx0XHRcdFx0c3RhcnRXYXRjaCgpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9O1xuXG5cdG1haW4oKTtcbn1dKTtcbid1c2Ugc3RyaWN0JztcblxuYW5ndWxhci5tb2R1bGUoJ0Zvcm1TZXJ2aWNlJywgW10pLmZhY3RvcnkoJ0Zvcm0nLCBbJyRodHRwJywgZnVuY3Rpb24gKCRodHRwKSB7XG5cblx0cmV0dXJuIHtcblxuXHRcdGNyZWF0ZTogZnVuY3Rpb24gY3JlYXRlKGRhdGEpIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2Zvcm1zJywgZGF0YSk7XG5cdFx0fSxcblxuXHRcdGdldEZvcm1MaXN0OiBmdW5jdGlvbiBnZXRGb3JtTGlzdCgpIHtcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvZm9ybXMvJyk7XG5cdFx0fSxcblxuXHRcdGdldDogZnVuY3Rpb24gZ2V0KGZvcm1JZCkge1xuXHRcdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9mb3Jtcy8nICsgZm9ybUlkKTtcblx0XHR9XG5cdH07XG59XSk7XG4ndXNlIHN0cmljdCc7XG5cbmFuZ3VsYXIubW9kdWxlKCdUcmF2ZWxlclNlcnZpY2UnLCBbXSkuZmFjdG9yeSgnVHJhdmVsZXInLCBbJyRodHRwJywgZnVuY3Rpb24gKCRodHRwKSB7XG5cbiAgICB2YXIgcmV2aWV3RGF0YSA9IHt9O1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICAvLyB0aGVzZSB3aWxsIHdvcmsgd2hlbiBtb3JlIEFQSSByb3V0ZXMgYXJlIGRlZmluZWQgb24gdGhlIE5vZGUgc2lkZSBvZiB0aGluZ3NcbiAgICAgICAgLy8gY2FsbCB0byBQT1NUIGFuZCBjcmVhdGUgYSBuZXcgZm9ybVxuICAgICAgICBjcmVhdGU6IGZ1bmN0aW9uIGNyZWF0ZShmb3JtRGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvdHJhdmVsZXInLCBmb3JtRGF0YSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0UmV2aWV3RGF0YTogZnVuY3Rpb24gZ2V0UmV2aWV3RGF0YSgpIHtcbiAgICAgICAgICAgIHJldHVybiByZXZpZXdEYXRhO1xuICAgICAgICB9LFxuXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KF9pZCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS90cmF2ZWxlcj9faWQ9JyArIF9pZCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2F2ZTogZnVuY3Rpb24gc2F2ZShkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucHV0KCcvYXBpL3RyYXZlbGVyJywgZGF0YSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0UmV2aWV3RGF0YTogZnVuY3Rpb24gc2V0UmV2aWV3RGF0YShkYXRhKSB7XG4gICAgICAgICAgICByZXZpZXdEYXRhID0gZGF0YTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZWFyY2hMaWtlOiBmdW5jdGlvbiBzZWFyY2hMaWtlKHNuKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3RyYXZlbGVyL3NlYXJjaExpa2UvJyArIHNuKTtcbiAgICAgICAgfSxcbiAgICAgICAgLy8gY2FsbCB0byBERUxFVEUgYSBmb3JtXG4gICAgICAgIHJlbW92ZVRyYXZlbGVyOiBmdW5jdGlvbiByZW1vdmVUcmF2ZWxlcihfaWQsIGlucHV0KSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhfaWQpO1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmRlbGV0ZSgnL2FwaS90cmF2ZWxlci8nICsgX2lkKTtcbiAgICAgICAgfVxuICAgIH07XG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ3NhbXBsZUFwcCcsIFxyXG5cdFtcclxuXHRcdCd1aS5yb3V0ZXInLCBcclxuXHRcdCdhcHBSb3V0ZXMnLCBcclxuXHJcblx0XHQnTWFpbkN0cmwnLCBcclxuXHRcdCdUcmF2ZWxlckN0cmwnLCBcclxuXHRcdCdTZWFyY2hUcmF2ZWxlckN0cmwnLCBcclxuXHRcdCdGb3JtR2VuQ3RybC5qcycsXHJcblx0XHRcclxuXHRcdCdUcmF2ZWxlclNlcnZpY2UnLCBcclxuXHRcdCdGb3JtU2VydmljZSdcclxuXHRdXHJcbik7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcFJvdXRlcycsIFsndWkucm91dGVyJ10pXHJcblx0LmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicgLFxyXG5cdFx0ZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpe1xyXG5cclxuXHRcdCR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy9ob21lJyk7XHJcblxyXG5cdFx0Ly8gJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xyXG5cdFx0JHN0YXRlUHJvdmlkZXJcclxuXHJcblx0XHRcdC8vIGhvbWUgcGFnZVxyXG5cdFx0XHQuc3RhdGUoJ2hvbWUnLCB7XHJcblx0XHRcdFx0dXJsOiAnL2hvbWUnLFxyXG5cdFx0XHRcdHRlbXBsYXRlVXJsOiAndmlld3MvaG9tZS5odG1sJyxcclxuXHRcdFx0XHRjb250cm9sbGVyOiAnTWFpbkNvbnRyb2xsZXInXHJcblx0XHRcdH0pXHJcblxyXG5cdFx0XHRcclxuXHRcdFx0LnN0YXRlKCd0cmF2ZWxlcicsIHtcclxuXHRcdFx0XHR1cmw6ICcvdHJhdmVsZXI/X2lkJmZvcm1JZCcsXHJcblx0XHRcdFx0dmlld3M6e1xyXG5cdFx0XHRcdFx0Jyc6e1xyXG5cdFx0XHRcdFx0XHR0ZW1wbGF0ZVVybDogJ3ZpZXdzL3RyYXZlbGVyLmh0bWwnLFxyXG5cdFx0XHRcdFx0XHRjb250cm9sbGVyOiAnVHJhdmVsZXJDb250cm9sbGVyJ1xyXG5cdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdCdmb3JtUmV2aWV3QHRyYXZlbGVyJzp7XHJcblx0XHRcdFx0XHRcdHRlbXBsYXRlVXJsOiAndmlld3MvZm9ybVJldmlldy5odG1sJyxcclxuXHRcdFx0XHRcdFx0Y29udHJvbGxlcjogZnVuY3Rpb24oJHNjb3BlLCBUcmF2ZWxlciwgRm9ybSl7XHJcblx0XHRcdFx0XHRcdFx0JHNjb3BlLnJldmlld0RhdGEgPSBUcmF2ZWxlci5nZXRSZXZpZXdEYXRhKCk7XHJcblx0XHRcdFx0XHRcdFx0Ly8gYWxlcnQoMTIzKTtcclxuXHRcdFx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZygkc2NvcGUucmV2aWV3RGF0YSk7XHJcblx0XHRcdFx0XHRcdFx0Ly8gYWxlcnQoJHNjb3BlLnJldmlld0RhdGEpO1xyXG5cdFx0XHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKDEyMyk7XHJcblx0XHRcdFx0XHRcdFx0Rm9ybS5nZXQoJHNjb3BlLnJldmlld0RhdGEuZm9ybUlkKVxyXG5cdFx0XHRcdFx0XHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSl7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKCdyZXZpZXcgaGVyZT8nKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coJHNjb3BlLnJldmlld0RhdGEuZm9ybUlkKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coZGF0YSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdCRzY29wZS5mb3JtcyA9IGRhdGE7XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pXHJcblxyXG5cdFx0XHQvLyAuc3RhdGUoJ25ld1RyYXZlbGVyJyx7XHJcblx0XHRcdC8vIFx0dXJsOiAnL25ld1RyYXZlbGVyJyxcclxuXHRcdFx0Ly8gXHR0ZW1wbGF0ZVVybDogJ3ZpZXdzL25ld1RyYXZlbGVyLmh0bWwnXHJcblx0XHRcdC8vIH0pXHJcblxyXG5cdFx0XHQuc3RhdGUoJ3NlYXJjaFRyYXZlbGVyJyx7XHJcblx0XHRcdFx0dXJsOiAnL3NlYXJjaFRyYXZlbGVyJyxcclxuXHRcdFx0XHR0ZW1wbGF0ZVVybDogJ3ZpZXdzL3NlYXJjaFRyYXZlbGVyLmh0bWwnLFxyXG5cdFx0XHRcdGNvbnRyb2xsZXI6ICdTZWFyY2hUcmF2ZWxlckNvbnRyb2xsZXInXHJcblx0XHRcdH0pXHJcblxyXG5cdFx0XHQuc3RhdGUoJ2Zvcm1HZW5lcmF0b3InLHtcclxuXHRcdFx0XHR1cmw6ICcvZm9ybUdlbmVyYXRvcicsXHJcblx0XHRcdFx0dGVtcGxhdGVVcmw6ICd2aWV3cy9mb3JtR2VuZXJhdG9yLmh0bWwnLFxyXG5cdFx0XHRcdGNvbnRyb2xsZXI6ICdGb3JtR2VuZXJhdG9yQ29udHJvbGxlcidcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0JGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ0Zvcm1HZW5DdHJsLmpzJywgW10pXHJcblx0XHJcblx0LmNvbnRyb2xsZXIoJ0Zvcm1HZW5lcmF0b3JDb250cm9sbGVyJywgWyckc2NvcGUnLCdGb3JtJyAsIGZ1bmN0aW9uKCRzY29wZSwgRm9ybSl7XHJcblxyXG5cdFx0JHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdHZhciBwYXNzd29yZCA9IHByb21wdCgncGFzc3dvcmQnKTtcclxuXHRcdFx0aWYocGFzc3dvcmQgPT09ICcxMjMnKXtcclxuXHRcdFx0Rm9ybS5jcmVhdGUoJHNjb3BlLnRlbXBsYXRlKVxyXG5cdFx0XHRcdC5zdWNjZXNzKGRhdGEgPT57XHJcblx0XHRcdFx0XHQvLyBkbyBzb21ldGhpbmdcclxuXHRcdFx0XHRcdGFsZXJ0KCdhZGQnKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0YWxlcnQoJ2dvIGhvbWUgc29uJyk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0fV0pOyIsImFuZ3VsYXIubW9kdWxlKCdNYWluQ3RybCcsIFtdKVxyXG5cdFxyXG5cdC5jb250cm9sbGVyKCdNYWluQ29udHJvbGxlcicsIFsnJHNjb3BlJywgZnVuY3Rpb24oJHNjb3BlKXtcclxuXHJcblx0XHQkc2NvcGUudGFnbGluZSA9ICd0byB0aGUgbW9vbiBhbmQgYmFjayEnO1xyXG59XSk7IiwiYW5ndWxhci5tb2R1bGUoJ1NlYXJjaFRyYXZlbGVyQ3RybCcsIFtdKVxyXG5cclxuXHQuY29udHJvbGxlcignU2VhcmNoVHJhdmVsZXJDb250cm9sbGVyJywgWyckc2NvcGUnLCAnVHJhdmVsZXInLCBmdW5jdGlvbigkc2NvcGUsIFRyYXZlbGVyKXtcclxuXHJcblx0XHQkc2NvcGUuaXNTZWFyY2ggPSBmYWxzZTtcclxuXHJcblx0XHQkc2NvcGUuc2VhcmNoID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0JHNjb3BlLmN1cnJlbnRJbnB1dCA9ICRzY29wZS5zZWFyY2hJbnB1dDtcclxuXHRcdFx0JHNjb3BlLmlzU2VhcmNoID0gdHJ1ZTtcclxuXHRcdFx0aWYoJHNjb3BlLnNlYXJjaElucHV0KXtcclxuXHRcdFx0XHRsZXQgc24gPSAkc2NvcGUuc2VhcmNoSW5wdXQudG9TdHJpbmcoKTtcclxuXHRcdFx0XHRUcmF2ZWxlci5zZWFyY2hMaWtlKHNuKVxyXG5cclxuXHRcdFx0XHRcdC5zdWNjZXNzKCBkYXRhID0+e1xyXG5cdFx0XHRcdFx0XHQkc2NvcGUucmVzdWx0PWRhdGE7XHJcblxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblxyXG5cdFx0JHNjb3BlLmVkaXRUcmF2ZWxlciA9IGZ1bmN0aW9uKF9pZCwgZm9ybUlkKXtcclxuXHRcdFx0d2luZG93Lm9wZW4oJ3RyYXZlbGVyP19pZD0nK19pZCsnJmZvcm1JZD0nK2Zvcm1JZCwgJ19ibGFuaycpO1xyXG5cdFx0fTtcclxuXHJcblx0XHQkc2NvcGUucmVtb3ZlVHJhdmVsZXIgPSBmdW5jdGlvbihfaWQsIGluZGV4KXtcclxuXHRcdFx0VHJhdmVsZXIucmVtb3ZlVHJhdmVsZXIoX2lkKVxyXG5cdFx0XHRcdC5zdWNjZXNzKCBkYXRhID0+IHtcclxuXHRcdFx0XHRcdC8vICRzY29wZS5yZXN1bHQ9ZGF0YTtcclxuXHRcdFx0XHRcdCRzY29wZS5yZXN1bHQuc3BsaWNlKGluZGV4LCAxKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH07XHJcblx0fV0pOyIsImFuZ3VsYXIubW9kdWxlKCdUcmF2ZWxlckN0cmwnLCBbXSlcclxuXHRcclxuXHQuY29udHJvbGxlcignVHJhdmVsZXJDb250cm9sbGVyJywgWyckc2NvcGUnLCdUcmF2ZWxlcicsICdGb3JtJywnJHN0YXRlUGFyYW1zJywgZnVuY3Rpb24oJHNjb3BlLCBUcmF2ZWxlciwgRm9ybSwgJHN0YXRlUGFyYW1zKXtcclxuXHJcblx0XHQkc2NvcGUudXBkYXRlRm9ybSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQkc2NvcGUudHJhdmVsZXJEYXRhID0ge307XHJcblx0XHRcdGlmKCRzY29wZS5mb3JtSWQpe1xyXG5cdFx0XHRcdEZvcm0uZ2V0KCRzY29wZS5mb3JtSWQpXHJcblx0XHRcdFx0XHQuc3VjY2VzcyhmdW5jdGlvbihkYXRhKXtcclxuXHRcdFx0XHRcdFx0JHNjb3BlLmZvcm1zID0gZGF0YTtcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHQvLyBmaW5kIHRoZSBsYXN0IHN1YlN0ZXBcclxuXHRcdFx0XHRcdFx0JHNjb3BlLmxhc3RTdGVwID0gZGF0YS5zdGVwcy5sZW5ndGg7XHJcblx0XHRcdFx0XHRcdCRzY29wZS50cmF2ZWxlckRhdGEuZm9ybUlkID0gZGF0YS5mb3JtSWQ7XHJcblx0XHRcdFx0XHRcdC8vICRzY29wZS5sYXN0U3ViU3RlcCA9IGRhdGEuZm9ybXMuc3RlcHNbZGF0YS5mb3Jtcy5zdGVwcy5sZW5ndGgtMV0ubGlzdC5sZW5ndGg7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHJcblx0XHQkc2NvcGUubmV4dFN0ZXAgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHQvLyBhcHBlbmRTdWJTdGVwRWRpdEluZm8oKTtcclxuXHRcdFx0dmFyIG9iamVjdCA9ICRzY29wZS5mb3Jtcy5zdGVwc1skc2NvcGUuY3VycmVudFN0ZXAtMV07XHJcblx0XHRcdGlmKG9iamVjdC5saXN0Lmxlbmd0aCA+PSAkc2NvcGUuY3VycmVudFN1YlN0ZXArMSl7XHJcblx0XHRcdFx0JHNjb3BlLmN1cnJlbnRTdWJTdGVwICs9IDE7XHRcclxuXHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0JHNjb3BlLmN1cnJlbnRTdGVwICs9IDE7XHJcblx0XHRcdFx0JHNjb3BlLmN1cnJlbnRTdWJTdGVwID0gMTtcclxuXHRcdFx0XHRpZigkc2NvcGUuY3VycmVudFN0ZXAgPiAkc2NvcGUubGFzdFN0ZXApe1xyXG5cdFx0XHRcdFx0VHJhdmVsZXIuc2V0UmV2aWV3RGF0YSgkc2NvcGUudHJhdmVsZXJEYXRhKTtcclxuXHRcdFx0XHRcdCRzY29wZS5yZWFkeVN1Ym1pdCA9IHRydWU7XHRcdFxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHJcblx0XHQkc2NvcGUuc3RhdHVzUGFnZSA9IGZ1bmN0aW9uKHBhZ2Upe1xyXG5cdFx0XHQvLyBhcHBlbmRTdWJTdGVwRWRpdEluZm8oKTtcclxuXHRcdFx0JHNjb3BlLmN1cnJlbnRTdGVwID0gcGFnZTtcclxuXHRcdFx0JHNjb3BlLmN1cnJlbnRTdWJTdGVwID0gMTtcclxuXHRcdFx0JHNjb3BlLnJlYWR5U3VibWl0ID0gZmFsc2U7XHJcblx0XHR9O1xyXG5cclxuXHRcdCRzY29wZS5zdGF0dXNTdWJQYWdlID0gZnVuY3Rpb24ocGFnZSl7XHJcblx0XHRcdC8vIGFwcGVuZFN1YlN0ZXBFZGl0SW5mbygpO1xyXG5cdFx0XHQkc2NvcGUuY3VycmVudFN1YlN0ZXAgPSBwYWdlO1xyXG5cdFx0fTtcclxuXHJcblx0XHQkc2NvcGUuZ29CYWNrID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0JHNjb3BlLmN1cnJlbnRTdGVwID0gMTtcclxuXHRcdFx0JHNjb3BlLmN1cnJlbnRTdWJTdGVwID0gMTtcclxuXHRcdFx0JHNjb3BlLnJlYWR5U3VibWl0ID0gZmFsc2U7XHJcblx0XHR9O1xyXG5cclxuXHRcdCRzY29wZS5zYXZlID0gZnVuY3Rpb24oKXtcclxuXHJcblx0XHRcdGlmKCRzY29wZS50cmF2ZWxlckRhdGEuY3JlYXRlZCl7XHJcblx0XHRcdFx0aWYoYXBwZW5kU3ViU3RlcEVkaXRJbmZvKCkpe1xyXG5cclxuXHRcdFx0XHRcdFRyYXZlbGVyLnNhdmUoJHNjb3BlLnRyYXZlbGVyRGF0YSlcclxuXHRcdFx0XHRcdFx0LnN1Y2Nlc3MoZGF0YSA9PntcclxuXHRcdFx0XHRcdFx0XHQvLyBkbyBzb21ldGhpbmdcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHQkc2NvcGUuc3VibWl0KCk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblxyXG5cdFx0JHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdGlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VybmFtZScpLnZhbHVlKXtcclxuXHRcdFx0XHQvLyAkc2NvcGUudHJhdmVsZXJEYXRhLmNvbXBsZXRlZCA9IGZhbHNlO1xyXG5cdFx0XHRcdCRzY29wZS50cmF2ZWxlckRhdGEuY3JlYXRlZCA9IHRydWU7XHJcblx0XHRcdFx0JHNjb3BlLnRyYXZlbGVyRGF0YS5jcmVhdGVkQnkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWUnKS52YWx1ZTtcclxuXHRcdFx0XHQkc2NvcGUudHJhdmVsZXJEYXRhLmNyZWF0ZUF0ID0gbmV3IERhdGUoKTtcclxuXHRcdFx0XHRUcmF2ZWxlci5jcmVhdGUoJHNjb3BlLnRyYXZlbGVyRGF0YSlcclxuXHJcblx0XHRcdFx0XHQvLyBpZiBzdWNjZXNzZnVsIGNyZWF0ZVxyXG5cdFx0XHRcdFx0LnN1Y2Nlc3MoIGRhdGEgPT57XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKGRhdGEpO1xyXG5cdFx0XHRcdFx0XHQkc2NvcGUudHJhdmVsZXJEYXRhID0gZGF0YTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRhbGVydCgnZW50ZXIgeW91IG5hbWUgcGx6Jyk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblxyXG5cdFx0JHNjb3BlLm5ldyA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdHJlc2V0KCk7XHJcblx0XHR9O1xyXG5cclxuXHRcdCRzY29wZS5kZWxldGUgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHRhbGVydCgnZGVsZXRlIGNsaWNrJyk7XHJcblx0XHRcdGlmKCRzY29wZS50cmF2ZWxlckRhdGEuX2lkKXtcclxuXHRcdFx0XHRUcmF2ZWxlci5yZW1vdmVUcmF2ZWxlcigkc2NvcGUudHJhdmVsZXJEYXRhLl9pZClcclxuXHRcdFx0XHRcdC5zdWNjZXNzKGRhdGEgPT4ge1xyXG5cdFx0XHRcdFx0XHRyZXNldCgpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblxyXG5cclxuXHRcdHZhciBhcHBlbmRTdWJTdGVwRWRpdEluZm8gPSBmdW5jdGlvbigpe1xyXG5cdFx0XHR2YXIgdXNlcm5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlcm5hbWUnKS52YWx1ZTtcclxuXHRcdFx0aWYodXNlcm5hbWUgIT09ICcnKXtcclxuXHRcdFx0XHR2YXIgY3VycmVudFN0ZXAgPSAkc2NvcGUuY3VycmVudFN0ZXA7XHJcblx0XHRcdFx0dmFyIGN1cnJlbnRTdWJTdGVwID0gJHNjb3BlLmN1cnJlbnRTdWJTdGVwO1xyXG5cdFx0XHRcdCRzY29wZS50cmF2ZWxlckRhdGEuc3RlcFtjdXJyZW50U3RlcF1bY3VycmVudFN1YlN0ZXBdLmVkaXRCeSA9IHVzZXJuYW1lO1xyXG5cdFx0XHRcdCRzY29wZS50cmF2ZWxlckRhdGEuc3RlcFtjdXJyZW50U3RlcF1bY3VycmVudFN1YlN0ZXBdLmVkaXRUaW1lID0gbmV3IERhdGUoKTtcclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRhbGVydCgnZW50ZXIgeW91ciBuYW1lJyk7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH07XHJcblxyXG5cdFx0dmFyIGxvYWRGb3JtTGlzdCA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdEZvcm0uZ2V0Rm9ybUxpc3QoKVxyXG5cdFx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpe1xyXG5cdFx0XHRcdFx0JHNjb3BlLmZvcm1MaXN0ID0gZGF0YTtcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cclxuXHJcblx0XHR2YXIgcmVzZXQgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHQkc2NvcGUudHJhdmVsZXJEYXRhID0ge307XHJcblx0XHRcdCRzY29wZS5jdXJyZW50U3RlcCA9IDE7XHJcblx0XHRcdCRzY29wZS5jdXJyZW50U3ViU3RlcCA9IDE7XHJcblx0XHRcdCRzY29wZS5yZWFkeVN1Ym1pdCA9IGZhbHNlO1xyXG5cdFx0XHQkc2NvcGUuZm9ybUlkID0gJyc7XHJcblx0XHRcdCRzY29wZS5pc05ldyA9IHRydWU7XHJcblx0XHR9O1xyXG5cclxuXHRcdHZhciBzdGFydFdhdGNoID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0JHNjb3BlLiR3YXRjaChcclxuXHRcdFx0XHQndHJhdmVsZXJEYXRhLnN0ZXAnLFxyXG5cdFx0XHRcdGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSl7XHJcblx0XHRcdFx0XHRpZighJHNjb3BlLmlzTmV3KXtcclxuXHRcdFx0XHRcdFx0JHNjb3BlLmlzTmV3ID0gdHJ1ZTtcclxuXHRcdFx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZygkc2NvcGUuY3VycmVudFN0ZXAgKyAnOycrJHNjb3BlLmN1cnJlbnRTdWJTdGVwKydjaGFuZ2VkJyk7XHJcblx0XHRcdFx0XHRcdGFwcGVuZFN1YlN0ZXBFZGl0SW5mbygpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0sIHRydWVcclxuXHRcdFx0KTtcclxuXHRcdH07XHJcblxyXG5cdFx0dmFyIG1haW4gPSBmdW5jdGlvbigpe1xyXG5cdFx0XHRyZXNldCgpO1xyXG5cdFx0XHRsb2FkRm9ybUxpc3QoKTtcclxuXHJcblx0XHRcdGlmKCRzdGF0ZVBhcmFtcy5mb3JtSWQpe1xyXG5cdFx0XHRcdCRzY29wZS5mb3JtSWQgPSAkc3RhdGVQYXJhbXMuZm9ybUlkO1xyXG5cdFx0XHRcdCRzY29wZS51cGRhdGVGb3JtKCk7XHJcblx0XHRcdFx0JHNjb3BlLmlzTmV3ID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHJcblxyXG5cdFx0XHRpZigkc3RhdGVQYXJhbXMuX2lkKXtcclxuXHRcdFx0XHQkc2NvcGUuaXNOZXcgPSBmYWxzZTtcclxuXHRcdFx0XHRUcmF2ZWxlci5nZXQoJHN0YXRlUGFyYW1zLl9pZClcclxuXHRcdFx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpe1xyXG5cdFx0XHRcdFx0XHQvLyBkYXRhIGlzIGEgYXJyYXkuIHJlc3VsdCBjb3VsZCBiZSBtb3JlIHRoYW4gb25lXHJcblx0XHRcdFx0XHRcdC8vIG5lZWQgdG8gZGVhbCB3aXQgdGhpcy5cclxuXHRcdFx0XHRcdFx0JHNjb3BlLnRyYXZlbGVyRGF0YSA9IGRhdGE7XHJcblx0XHRcdFx0XHRcdHN0YXJ0V2F0Y2goKTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cclxuXHRcdG1haW4oKTtcclxufV0pOyIsImFuZ3VsYXIubW9kdWxlKCdGb3JtU2VydmljZScsIFtdKVxyXG5cclxuXHQuZmFjdG9yeSgnRm9ybScsIFsnJGh0dHAnLCBmdW5jdGlvbigkaHR0cCl7XHJcblxyXG5cdFx0cmV0dXJuIHtcclxuXHJcblx0XHRcdGNyZWF0ZTogZnVuY3Rpb24oZGF0YSl7XHJcblx0XHRcdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvZm9ybXMnLCBkYXRhKTtcclxuXHRcdFx0fSxcclxuXHJcblx0XHRcdGdldEZvcm1MaXN0OiBmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvZm9ybXMvJyk7XHJcblx0XHRcdH0sXHJcblxyXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKGZvcm1JZCl7XHJcblx0XHRcdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9mb3Jtcy8nK2Zvcm1JZCk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcbn1dKTsiLCJhbmd1bGFyLm1vZHVsZSgnVHJhdmVsZXJTZXJ2aWNlJywgW10pXHJcbiAgICAgICBcclxuICAgIC5mYWN0b3J5KCdUcmF2ZWxlcicsIFsnJGh0dHAnLCBmdW5jdGlvbigkaHR0cCl7XHJcblxyXG4gICAgICAgIHZhciByZXZpZXdEYXRhID0ge307XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIHJldHVybiB7XHJcblx0XHJcbiAgICAgICAgICAgIC8vIHRoZXNlIHdpbGwgd29yayB3aGVuIG1vcmUgQVBJIHJvdXRlcyBhcmUgZGVmaW5lZCBvbiB0aGUgTm9kZSBzaWRlIG9mIHRoaW5nc1xyXG4gICAgICAgICAgICAvLyBjYWxsIHRvIFBPU1QgYW5kIGNyZWF0ZSBhIG5ldyBmb3JtXHJcbiAgICAgICAgICAgIGNyZWF0ZTogZnVuY3Rpb24oZm9ybURhdGEpe1xyXG4gICAgICAgICAgICBcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3RyYXZlbGVyJywgZm9ybURhdGEpO1xyXG4gICAgICAgICAgICB9LCBcclxuXHJcbiAgICAgICAgICAgIGdldFJldmlld0RhdGE6IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmV2aWV3RGF0YTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24oX2lkKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdHJhdmVsZXI/X2lkPScrIF9pZCk7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBzYXZlOiBmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5wdXQoJy9hcGkvdHJhdmVsZXInLCBkYXRhKTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIHNldFJldmlld0RhdGE6IGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgICAgICAgcmV2aWV3RGF0YSA9IGRhdGE7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBzZWFyY2hMaWtlOiBmdW5jdGlvbihzbil7XHJcbiAgICAgICAgICAgIFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS90cmF2ZWxlci9zZWFyY2hMaWtlLycrIHNuKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgLy8gY2FsbCB0byBERUxFVEUgYSBmb3JtXHJcbiAgICAgICAgICAgIHJlbW92ZVRyYXZlbGVyOiBmdW5jdGlvbihfaWQsIGlucHV0KXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKF9pZCk7XHJcbiAgICAgICAgICAgIFx0cmV0dXJuICRodHRwLmRlbGV0ZSgnL2FwaS90cmF2ZWxlci8nKyBfaWQpO1xyXG4gICAgICAgICAgICB9XHJcblx0fTtcdFx0XHJcbn1dKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
