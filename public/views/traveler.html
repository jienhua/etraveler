<div class='container'>

	<div ng-show='!travelerData.readyReview''>
		<button
		    class='btn btn-default btn-xs pull-right hidden-print'
		    type='button'
		    ng-click='topCollapse = !topCollapse'
		    ng-show='!topCollapse'
		>
		    <i class="fa fa-minus-square-o" aria-hidden="true"></i>
		</button>
		<button
		    class='btn btn-default btn-xs pull-right hidden-print'
		    type='button'
		    ng-click='topCollapse = !topCollapse'
		    ng-show='topCollapse'

		>  
			<i class="fa fa-plus-square-o" aria-hidden="true"></i>
		</button>
	</div>
	<br>
	<div ng-show='topCollapse && !travelerData.readyReview'>
		<h4>Doc Num: {{travelerData.itemRecord.docNum}}</h4>
		<h4>Serial Number: {{travelerData.sn}}</h4>
		<h4 ng-show='isWorkFind'>Work Number: {{input.inputWorkNum}}</h4>
		<button class='btn btn-primary btn-md pull-right' ng-click='checkReadyReview()'>
			<!-- <i class="fa fa-check" aria-hidden="true"></i>  -->
			Ready for Review						
		</button>
		<button class='btn btn-primary btn-md pull-right' ng-click='save()' style='margin-right: 3px'>
			<!-- <i class="fa fa-check" aria-hidden="true"></i>  -->
			Save				
		</button>
		<br>
		<hr>
	</div>
	<div ng-show='!topCollapse && !travelerData.readyReview'>
		<input type='button' class='btn btn-warning btn-md pull-right myButton hidden-print' value='New' ng-click='new()'/>
		<input type='button' class='btn btn-danger btn-md pull-right myButton hidden-print' value='Delete' ng-click='delete()'/>
		<form role='form'>
			<div class='form-group hidden-print' style='margin-bottom: 0px'>
				<label for='select-formId'>Select a Template:</label>
				<select class='form-control' id='select-formId' ng-model='formId' ng-change='updateForm()' ng-disabled='travelerData.created'>
					<option value="">---Please select---</option>
					<option ng-repeat='option in formList |filter:{isPublish:true}' value='{{option._id}}'>Doc. {{option.formNo}} Rev. {{option.formRev}}</option>
				</select>
			</div>
		</form>
		<br>
	</div>

	<div ng-show='!travelerData.readyReview && formId'>

		<div name='itemRecord' ng-show='!topCollapse'>

			<uib-tabset active="activeForm">
				<!-- Single TAB //////////////////////////////////////////////////////////////////////////////// -->
		     	<uib-tab index="0" heading="Single">
		        	<div class='row'>
						<div class='col-xs-8'>
							<div class='col-xs-6'>

								<br>
								<div class='form-group input-group'>
									<input type="text" class='form-control' placeholder='Search Serial Number' ng-model='travelerData.sn' autofocus />
									<span class='input-group-btn'>
										<button class='btn btn-primary' type='button' ng-click='searchSN()'>
											<i class='glyphicon glyphicon-search'></i>
										</button>
									</span>
								</div>
								<span ng-show='isSNMoreThanOne' style='color:red;'>* Same Serial Number detect more than one in database.</span><br>


								<select ng-show='isSNMoreThanOne' class='form-control' style='width:auto;' ng-model='selectSearchSN'>
									<option ng-repeat='item in searchSNList' value='{{$index}}'>
										Create At: {{item.createAt|date: 'shortDate'}}  Status: {{item.status}} {{$index}}
									</option>
								</select>
								

								<br>
								<button ng-show='isSNMoreThanOne' class='btn btn-primary btn-sm' ng-click='setTravelerData(selectSearchSN)'>
									Open/Use
								</button>
							</div>
							<div class='col-xs-6'>
								<h4>Customer</h4><span> - {{forms.customer}}</span>
								<h4>Status</h4><span> - {{travelerData.status}}</span>
							</div>
						</div>
						<div class='col-xs-4'>
							<br>
							<button class='btn btn-primary btn-md pull-right' ng-click='checkReadyReview()'>
								Ready for Review						
							</button>
							<button class='btn btn-primary btn-md pull-right' ng-click='save()' style='margin-right: 3px'>
								save				
							</button>
						</div>
					</div>
								  		<div class='form-group'>
						<label class='control-label' for='docNumSelect'>Select Document#:</label>
							<select ng-init='docNum.docNumSelect="new"' class='form-control' id='docNumSelect' ng-model='docNum.docNumSelect' ng-change='updateDocNum()'>
								<option value='new'>Create New Doc#</option>
								<optgroup ng-repeat='op in docNum.docNumSelectList | unique:"docNum" | orderBy:"docNum"' label='{{op.docNum}}'>
									<option ng-repeat='chilop in docNum.docNumSelectList' ng-show='chilop.docNum === op.docNum' value='{{$index}}'>Doc# {{op.docNum}} Model - {{chilop.label}}</option>
								</optgroup>
							</select>
					</div>
					<div class='form-inline' role='form'>
						<div class='form-group'>
							<label for='docNum'>Document#</label>
							<input type="text" id='docNum' class='form-control' ng-model='docNum.docNumData.docNum' ng-disabled='docNum.docNumSelect !== "new"'>
						</div>
						<div class='form-group' ng-repeat='item in forms.itemRecord'>
							<label for='{{item.Description}}'>{{item.Description}}: </label>
							<input ng-show="!item.select && !item.radio && !item.checkbox" type='text' class='form-control' id='{{item.Description}}' ng-model='docNum.docNumData.attribute[item.Description]'>
									
							<!-- select -->
							<select class='form-control' ng-show='item.select' ng-model='docNum.docNumData.attribute[item.Description]["select"]'>
								<option value="">---Please select---</option>
								<option ng-repeat='option in item.select.options' value='{{option}}'>
									{{option}}
								</option>
							</select>
						</div>

						<div class='form-group' ng-show='docNum.docNumSelect !== "new"'>
							<button class='btn btn-primary btn-md pull-right' ng-click='editDocNum()'>
								Edit/Save						
							</button>
						</div>
						<div class='form-group' ng-show='docNum.docNumSelect === "new"'>
							<button class='btn btn-primary btn-md pull-right' ng-click='saveDocNum()'>
								Create						
							</button>
						</div>
					</div>
		    	</uib-tab>
		      	<!-- Group TAB //////////////////////////////////////////////////////////////////////////////// -->
				<uib-tab index="1" heading="Group">
			  		<div class='form-group'>
						<label class='control-label' for='docNumSelect'>Select Document#:</label>
							<select ng-init='docNum.docNumSelect="new"' class='form-control' id='docNumSelect' ng-model='docNum.docNumSelect' ng-change='updateDocNum()'>
								<option value='new'>Create New Doc#</option>
								<optgroup ng-repeat='op in docNum.docNumSelectList | unique:"docNum" | orderBy:"docNum"' label='{{op.docNum}}'>
									<option ng-repeat='chilop in docNum.docNumSelectList' ng-show='chilop.docNum === op.docNum' value='{{$index}}'>Doc# {{op.docNum}} Model - {{chilop.label}}</option>
								</optgroup>
							</select>
					</div>
					<div class='form-inline' role='form'>
						<div class='form-group'>
							<label for='docNum'>Document#</label>
							<input type="text" id='docNum' class='form-control' ng-model='docNum.docNumData.docNum' ng-disabled='docNum.docNumSelect !== "new"'>
						</div>
						<div class='form-group' ng-repeat='item in forms.itemRecord'>
							<label for='{{item.Description}}'>{{item.Description}}: </label>
							<input ng-show="!item.select && !item.radio && !item.checkbox" type='text' class='form-control' id='{{item.Description}}' ng-model='docNum.docNumData.attribute[item.Description]'>
									
							<!-- select -->
							<select class='form-control' ng-show='item.select' ng-model='docNum.docNumData.attribute[item.Description]["select"]'>
								<option value="">---Please select---</option>
								<option ng-repeat='option in item.select.options' value='{{option}}'>
									{{option}}
								</option>
							</select>
						</div>

						<div class='form-group' ng-show='docNum.docNumSelect !== "new"'>
							<button class='btn btn-primary btn-md pull-right' ng-click='editDocNum()'>
								Edit/Save						
							</button>
						</div>
						<div class='form-group' ng-show='docNum.docNumSelect === "new"'>
							<button class='btn btn-primary btn-md pull-right' ng-click='saveDocNum()'>
								Create						
							</button>
						</div>
					</div>
					<div class='row well'>
						<div class='col-sm-12'>
							<div class='col-sm-6'>
								<h5>add sn <span ng-show='isSNExist' style='color:red;'>* Same Serial Number detect in database.</span></h5>
								<div class='form-group input-group'>
									<input type="text" class='form-control' placeholder='Serial Number' ng-model='inputSN'>
									<span class='input-group-btn'>
										<button class='btn btn-primary' ng-click='checkForSN()'>
											<i class="fa fa-plus" aria-hidden="true"></i>
										</button>
									</span>
								</div>
							</div>
							<!-- <div class='col-sm-6'> -->
							<div class='col-xs-3'>
								<h5>Search a Work</h5>
								<div class='form-group input-group'>
									<input type="text" class='form-control' placeholder="Search" ng-model='input.inputWorkNum'>
										<span class='input-group-btn'>
											<button class='btn btn-primary' ng-click='searchWorkNum(input.inputWorkNum)'>
												<i class="fa fa-search" aria-hidden="true"></i>
											</button>
										</span>
								</div>
							</div>
							<div class='col-xs-3'>
								<h5>Create a new Work</h5>
								<button class='btn btn-primary' ng-click='createWork()'>
									<i class="fa fa-files-o" aria-hidden="true"> Create</i>
								</button>
							</div>
							<!-- </div> -->
						</div>
						<div class='col-sm-12'>
							<div class='col-sm-6'>
								<h5>sn filter Total: {{SNListForDocNum.length}}</h5>
									<div class='form-group input-group'>
										<input type="text" class='form-control' placeholder="Filter" ng-model='searchSNListForDocNum.sn'>
										<span class='input-group-btn'>
											<button class='btn btn-primary' ng-click='selectAllList(SNListForDocNum)'> 
												<i class="fa fa-check-square-o" aria-hidden="true"></i>
											</button>
										</span>
									</div>
									<div style="background-color:white; height:100px; width:100%; overflow:auto; padding:2px" >
										<table>
											<tr ng-repeat='item in SNListForDocNum |orderBy:"sn"| filter:searchSNListForDocNum'>
												<td>
													<input type="checkbox" 
														   ng-model='item.checkbox'
														   id='checkbox1+{{$index}}'
															>
													<label for='checkbox1+{{$index}}'>{{item.sn}} - {{item.status}} - {{item.createAt | date:medium}} <span ng-show='item.workNum'> -  Work#: {{item.workNum}}</span></label>
												</td>
											</tr>
										</table>
									</div>
									<button class='btn btn-primary' ng-click='moveToSelectSNList()'>
										<i class="fa fa-arrow-right" aria-hidden="true"></i>
									</button>
							</div>
							<div class='col-sm-6'>
								<h5>select sn Total: {{selectSNList.length}}</h5>
								<div class='form-group input-group'>
									<input type="text" class='form-control' placeholder="Filter" ng-model='searchSelectSNList.sn'>
									<span class='input-group-btn'>
										<button class='btn btn-primary' ng-click='selectAllList(selectSNList)'> 
											<i class="fa fa-check-square-o" aria-hidden="true"></i>
										</button>
									</span>
								</div>
								<div style="background-color:white; height:100px; width:100%; overflow:auto; padding:2px" >
									<table>
										<tr ng-repeat='item in selectSNList |orderBy:"sn" | filter:searchSelectSNList'>
											<td>
												<input type="checkbox" 
													   ng-model='item.checkbox'
													   id='checkbox2+{{$index}}'
												>
												<label for='checkbox2+{{$index}}'>{{item.sn}} - {{item.status}} - {{item.createAt | date:medium}} <span ng-show='item.workNum'> - Work#: {{item.workNum}}</span></label>
											</td>
										</tr>
									</table>		
								</div>
								<button class='btn btn-primary' ng-click='moveToSNListForDocNum()'>
									<i class="fa fa-arrow-left" aria-hidden="true"></i>
								</button>
							</div>
						</div>
						<div class='col-sm-12'>
							<br>
							<!-- <select ng-init='selectSN = "all"' class='form-control' ng-model='selectSN' ng-change='loadTraveler(selectSN)'>
								<option value='all'>Apply Change For All</option>
								<option ng-repeat='item in selectSNList | orderBy:"sn"' value='{{item._id}}'> {{item.sn}}</option>
							</select> -->

						</div>
					</div>
				</uib-tab>
	    	</uib-tabset>
			
			<!-- {{SNListForDocNum}}
			<hr>
			{{selectSNList}} -->
			<br>
			<hr style='margin-top: 1px; margin-bottom: 4px'>
		</div>

		<div name='steps' ng-show='isStartWork && selectSNList.length>0'>
				<h4 ng-show='isWorkFind'>Work Number: {{input.inputWorkNum}}</h4>
				<div id='form-container'>
					<h4>Step {{currentStep}}.{{currentSubStep}}</h4>

					<div id='status-buttons' class='text-right'>
						<a ng-class='{active: currentStep == step.step}' ng-repeat='step in forms.steps' ng-click='statusPage(step.step)'><span>{{step.step}}</span></a>
					</div>

					<input class='btn btn-primary myButton btn-md pull-right' ng-show='!travelerData.readyReview' type="button" value='Next' ng-click='nextStep()'/>
					<div id='steps' ng-repeat='step in forms.steps'>
						<div class='page-header' ng-show='currentStep == step.step'>
						 <h4>{{step.type}} :: {{step.Description}}</h4>
						</div>
						<!-- Step -->
						<div ng-repeat='subStep in step.list'>

							<!-- form -->
							<form class='form-horizontal' role='form' ng-show='subStep.sub_step== currentSubStep && currentStep == step.step'>
								<h4><strong>{{subStep.Description}}</strong></h4>

								<div ng-show='subStep.options'>
									<div class='form-group' ng-repeat='op in subStep.options'>
										<label class='control-label col-sm-2'>{{op.name}}:</label>
										<div class='col-sm-10'>
											<div ng-show='op.type ==="checkbox"'>
											<!-- checkbox -->
												<label
													class='checkbox-inline' 
													ng-repeat='checkOp in op.options'
												>
													<input 
														type="checkbox" 
														value='{{checkOp}}'
														ng-model='travelerData.step[step.step][subStep.sub_step]["options"][$parent.$index][$index]'
														ng-change='appendSubStepEditInfo()'
														>{{checkOp}}
												</label>
											</div>
											<div ng-show='op.type ==="select"'>
											<!-- select -->
												<select 
													class='form-control'
													ng-model='travelerData.step[step.step][subStep.sub_step]["options"][$parent.$index]'
													ng-change='appendSubStepEditInfo()'>
													<option value=''>---Please select---</option>
													<option ng-repeat='selectOp in op.options'
															value='{{$index}}'>{{selectOp}}</option>
												</select>
											</div>
											<!-- radio -->
											<div ng-show='op.type ==="radio"'>
												<label ng-repeat='radioOp in op.options'
													   class='radio-inline'>
													<input 
														type="radio"
														name="radio"
														value='{{$index}}'
														ng-model='travelerData.step[step.step][subStep.sub_step]["options"][$parent.$index]'
														ng-change='appendSubStepEditInfo()'
														>{{radioOp}}
												</label>
											</div>
										</div>
									</div>
								</div>

								<div class='form-group'>
									<label class='control-label col-sm-2'>Qulity: </label>
									<div class='col-sm-10'>
										<input 
											type='number' 
											class='form-control' 
											placeholder='0' 
											ng-model='travelerData.step[step.step][subStep.sub_step]["qty"]'
											ng-change='appendSubStepEditInfo()'>
									</div>
								</div>	

								<!-- comment -->
								<div class='form-group'>
									<label for='comment' class='control-label col-sm-2'>Comment: </label>
									<div class='col-sm-10'>
										<textarea class='form-control' row='5' id='comment' ng-model='travelerData.step[step.step][subStep.sub_step]["comment"]' ng-change='appendSubStepEditInfo()'
										></textarea>
									</div>
								</div>
							</form>
						</div>

						<!-- status sub page -->
						<div id='status-buttons-sub' class='text-right'>
							<a ng-class='{active: currentSubStep == subStep.sub_step}' ng-repeat='subStep in step.list' ng-show='currentStep==step.step' ng-click='statusSubPage(subStep.sub_step)'><span>{{step.step}}.{{subStep.sub_step}}</span></a>
						</div>
					</div>			
				</div> 	
		</div>
	</div>

	<div ng-show='travelerData.readyReview' ui-view='formReview' id='div-id-selector'></div>

	<br>
	<!-- <input class='btn btn-primary myButton btn-lg pull-right' ng-show='!readySubmit' type="button" value='next' ng-click='nextStep()'/> -->
	<input class='btn btn-primary myButton btn-md pull-right hidden-print' ng-show='travelerData.readyReview && !travelerData.created' type="button" value='submit' ng-click='submit()'/>
	<input ng-show='formId' class='btn btn-primary myButton btn-md pull-right hidden-print'  type='button' value='Save' ng-click='save()'/>
	<input class='btn btn-primary myButton btn-md pull-right hidden-print' ng-show='travelerData.readyReview' type='button' value='Go Back' ng-click='goBack()'/>


	<br>
	<br>
	<br>
	<br>
	travelerData: <pre>{{travelerData |json}}</pre><br>
	<pre>{{testarea |json}}</pre>
	<pre>{{selectSNList}}</pre>
	<pre>{{isStartWork}}</pre>
	<!-- formTemplate: <pre>{{forms |json}}</pre><br> -->
	<!-- formId{{formId}} -->

</div>